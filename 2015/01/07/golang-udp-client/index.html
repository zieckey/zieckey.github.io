<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.89.4" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>golang网络编程-udp客户端示例代码 &middot; CodeG Blog</title>
  <meta name="description" content="介绍了golang如何实现一个udp客户端" />

  
  <link type="text/css" rel="stylesheet" href="http://blog.codeg.cncss/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="http://blog.codeg.cncss/poole.css">
  <link type="text/css" rel="stylesheet" href="http://blog.codeg.cncss/syntax.css">
  <link type="text/css" rel="stylesheet" href="http://blog.codeg.cncss/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://blog.codeg.cn"><h1>CodeG Blog</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="http://blog.codeg.cn">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2021. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>golang网络编程-udp客户端示例代码</h1>
  <time datetime=2015-01-07T00:00:00Z class="post-date">Wed, Jan 7, 2015</time>
  <h3 id="最简单的一个客户端">最简单的一个客户端</h3>
<p>编程步骤：</p>
<ol>
<li>创建一个udp socket并连接服务器</li>
<li>发送数据给服务器</li>
<li>从服务器接收数据</li>
<li>关闭udp socket</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span> 

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;net&#34;</span>
    <span style="color:#e6db74">&#34;os&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">hostport</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;10.16.28.17:1053&#34;</span>
    <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> {
    	<span style="color:#a6e22e">hostport</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>[<span style="color:#ae81ff">1</span>]
    }
   
    <span style="color:#a6e22e">addr</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">ResolveUDPAddr</span>(<span style="color:#e6db74">&#34;udp&#34;</span>, <span style="color:#a6e22e">hostport</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;server address error. It MUST be a format like this hostname:port&#34;</span>, <span style="color:#a6e22e">err</span>)
        <span style="color:#66d9ef">return</span>
    }

	<span style="color:#75715e">// Create a udp socket and connect to server        
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">socket</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">DialUDP</span>(<span style="color:#e6db74">&#34;udp4&#34;</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">addr</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;connect to udpserver %v failed : %v&#34;</span>, <span style="color:#a6e22e">addr</span>.<span style="color:#a6e22e">String</span>(), <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
        <span style="color:#66d9ef">return</span>
    }
    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">Close</span>()

	<span style="color:#75715e">// send data to server
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">senddata</span> <span style="color:#f92672">:=</span> []byte(<span style="color:#e6db74">&#34;hello server!&#34;</span>)
    <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">senddata</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;send data error &#34;</span>, <span style="color:#a6e22e">err</span>)
        <span style="color:#66d9ef">return</span>
    }

	<span style="color:#75715e">// recv data from server
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">data</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#ae81ff">4096</span>)
    <span style="color:#a6e22e">read</span>, <span style="color:#a6e22e">remoteAddr</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">ReadFromUDP</span>(<span style="color:#a6e22e">data</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;recv data error &#34;</span>, <span style="color:#a6e22e">err</span>)
        <span style="color:#66d9ef">return</span>
    }
    
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;server addr [%v], response data len:%v [%s]\n&#34;</span>, <span style="color:#a6e22e">remoteAddr</span>, <span style="color:#a6e22e">read</span>, string(<span style="color:#a6e22e">data</span>[:<span style="color:#a6e22e">read</span>]))
}
</code></pre></div><h3 id="udp-benchmark-client">udp benchmark client</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;bytes&#34;</span>
	<span style="color:#e6db74">&#34;flag&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;github.com/funny/overall&#34;</span>
	<span style="color:#e6db74">&#34;net&#34;</span>
	<span style="color:#e6db74">&#34;os&#34;</span>
	<span style="color:#e6db74">&#34;sync&#34;</span>
	<span style="color:#e6db74">&#34;sync/atomic&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">concurrence</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;Number of multiple requests to make&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">numRequest</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;Number of requests to perform&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">verbosity</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Bool</span>(<span style="color:#e6db74">&#34;v&#34;</span>, <span style="color:#66d9ef">false</span>, <span style="color:#e6db74">&#34;How much troubleshooting info to print&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">echoVerify</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Bool</span>(<span style="color:#e6db74">&#34;e&#34;</span>, <span style="color:#66d9ef">false</span>, <span style="color:#e6db74">&#34;the echo mode and verify the response data&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hostPort</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;h&#34;</span>, <span style="color:#e6db74">&#34;127.0.0.1:1053&#34;</span>, <span style="color:#e6db74">&#34;The hostname and port of the udp server&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">messageLen</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;l&#34;</span>, <span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#34;The length of the send message&#34;</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">timeoutMs</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;t&#34;</span>, <span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#34;The timeout milliseconds&#34;</span>)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Stat</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">send</span>       <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">recv</span>       <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">sendsucc</span>   <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">sendfail</span>   <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">recvsucc</span>   <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">recvfail</span>   <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">compareerr</span> <span style="color:#66d9ef">int64</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">Stat</span>) <span style="color:#a6e22e">dump</span>() <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;send:%v recv:%v sendsucc:%v recvsucc:%v compareerr:%v sendfail:%v recvfail:%v&#34;</span>,
		<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">send</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">recv</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">sendsucc</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">recvsucc</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">compareerr</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">sendfail</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">recvfail</span>)
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">stat</span> <span style="color:#a6e22e">Stat</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Parse</span>()
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">wg</span> <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">WaitGroup</span>
	<span style="color:#a6e22e">recoder</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">overall</span>.<span style="color:#a6e22e">NewTimeRecoder</span>()
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">c</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">c</span> &lt; <span style="color:#f92672">*</span><span style="color:#a6e22e">concurrence</span>; <span style="color:#a6e22e">c</span><span style="color:#f92672">++</span> {
		<span style="color:#66d9ef">go</span> <span style="color:#a6e22e">request</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">wg</span>, <span style="color:#a6e22e">recoder</span>)
		<span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#ae81ff">1</span>)
	}

	<span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Wait</span>()

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">dump</span>())

	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buf</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Buffer</span>
	<span style="color:#a6e22e">recoder</span>.<span style="color:#a6e22e">WriteCSV</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">buf</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">buf</span>.<span style="color:#a6e22e">String</span>())

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">compareerr</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">recvfail</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">sendfail</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">request</span>(<span style="color:#a6e22e">wg</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">WaitGroup</span>, <span style="color:#a6e22e">record</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">overall</span>.<span style="color:#a6e22e">TimeRecoder</span>) {
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Done</span>()
	
	<span style="color:#a6e22e">addr</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">ResolveUDPAddr</span>(<span style="color:#e6db74">&#34;udp&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">hostPort</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;server address error. It MUST be a format like this hostname:port&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span>
	}

	<span style="color:#75715e">// Create a udp socket and connect to server
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">socket</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">DialUDP</span>(<span style="color:#e6db74">&#34;udp4&#34;</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">addr</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;connect to udpserver %v failed : %v&#34;</span>, <span style="color:#a6e22e">addr</span>.<span style="color:#a6e22e">String</span>(), <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">Close</span>()

	<span style="color:#a6e22e">msg</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">messageLen</span>)
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#f92672">*</span><span style="color:#a6e22e">messageLen</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
		<span style="color:#a6e22e">msg</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">+</span> byte(<span style="color:#a6e22e">i</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">26</span>
	}

	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">n</span> &lt; <span style="color:#f92672">*</span><span style="color:#a6e22e">numRequest</span>; <span style="color:#a6e22e">n</span><span style="color:#f92672">++</span> {
		<span style="color:#a6e22e">t</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
		
		<span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">SetDeadline</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>(<span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>)))
		
		<span style="color:#75715e">// send data to server
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">msg</span>)
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;send data error &#34;</span>, <span style="color:#a6e22e">err</span>)
			<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">sendfail</span>, <span style="color:#ae81ff">1</span>)
			<span style="color:#66d9ef">return</span>
		}

		<span style="color:#75715e">// recv data from server
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">data</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#ae81ff">1472</span>)
		<span style="color:#a6e22e">read</span>, <span style="color:#a6e22e">remoteAddr</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">ReadFromUDP</span>(<span style="color:#a6e22e">data</span>)
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;recv data error &#34;</span>, <span style="color:#a6e22e">err</span>)
			<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">recvfail</span>, <span style="color:#ae81ff">1</span>)
			<span style="color:#66d9ef">return</span>
		}
		<span style="color:#a6e22e">data</span> = <span style="color:#a6e22e">data</span>[:<span style="color:#a6e22e">read</span>]
		<span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">Record</span>(<span style="color:#e6db74">&#34;onetrip&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">t</span>))

		<span style="color:#66d9ef">if</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">verbosity</span> {
			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;server addr [%v], response data len:%v [%s]\n&#34;</span>, <span style="color:#a6e22e">remoteAddr</span>, <span style="color:#a6e22e">read</span>, string(<span style="color:#a6e22e">data</span>[:<span style="color:#a6e22e">read</span>]))
		}

		<span style="color:#66d9ef">if</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">echoVerify</span> {
			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Compare</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">msg</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
				<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">compareerr</span>, <span style="color:#ae81ff">1</span>)
			}
		}

		<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">send</span>, <span style="color:#ae81ff">1</span>)
		<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">recv</span>, <span style="color:#ae81ff">1</span>)
		<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">sendsucc</span>, <span style="color:#ae81ff">1</span>)
		<span style="color:#a6e22e">atomic</span>.<span style="color:#a6e22e">AddInt64</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">stat</span>.<span style="color:#a6e22e">recvsucc</span>, <span style="color:#ae81ff">1</span>)
	}
}

</code></pre></div>
</div>


    </main>

    
      
    
  </body>
</html>
